/* Detecta movimento do mouse e exibe
   informações relacionadas */
programa mov_mouse;
inclui "gra*";
inclui "evnt*";

const
  X1 = 20; Y1 = 20;
  DX = 300; DY = 40;

var
  x, y, nmovs: inteiro;
  msg: texto;

/* tem_mov_mouse - detecta movimento do mouse;
   coloca em (x, y) a posição corrente;
   se o usuário usar o teclado, retorna 'não' */
função tem_mov_mouse(var x, y: inteiro): lógico;
início
  espere_por(EV_MOV_MOUSE + EV_TECLADO);
  se (último_evento() = EV_TECLADO)
    retorne não;
  mouse_xy(x, y);
  retorne sim;
fim;

/* msg_mov - monta mensagem com informações sobre
   o movimento do mouse */
função msg_mov(x, y, num: inteiro): texto;
início
  retorne int_para_txt(x) + ", " + int_para_txt(y) + " - " +
          "Cont = " + int_para_txt(num);
fim;

início
  /* inicia a contagem e altera a fonte */
  nmovs := 0;
  alt_tam_fonte(tela, 20);

  /* trata os eventos */
  enquanto (tem_mov_mouse(x, y))
  início
    nmovs++;
    dsn_ret(tela, X1, Y1, X1 + DX, Y1 + DY);
    dsn_txt(tela, X1 + 2, Y1 + 2, msg_mov(x, y, nmovs));
  fim;
fim.
